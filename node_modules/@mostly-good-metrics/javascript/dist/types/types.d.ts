/**
 * Configuration options for the MostlyGoodMetrics SDK.
 */
export interface MGMConfiguration {
    /**
     * The API key for authenticating with MostlyGoodMetrics.
     * Required.
     */
    apiKey: string;
    /**
     * The base URL for the MostlyGoodMetrics API.
     * @default "https://ingest.mostlygoodmetrics.com"
     */
    baseURL?: string;
    /**
     * The environment name (e.g., "production", "staging", "development").
     * @default "production"
     */
    environment?: string;
    /**
     * Maximum number of events to send in a single batch.
     * Must be between 1 and 1000.
     * @default 100
     */
    maxBatchSize?: number;
    /**
     * Interval in seconds between automatic flush attempts.
     * Must be at least 1 second.
     * @default 30
     */
    flushInterval?: number;
    /**
     * Maximum number of events to store locally before dropping oldest events.
     * Must be at least 100.
     * @default 10000
     */
    maxStoredEvents?: number;
    /**
     * Whether to enable debug logging to the console.
     * @default false
     */
    enableDebugLogging?: boolean;
    /**
     * Whether to automatically track app lifecycle events
     * ($app_opened, $app_backgrounded, $app_installed, $app_updated).
     * @default true
     */
    trackAppLifecycleEvents?: boolean;
    /**
     * Custom bundle identifier to use instead of auto-detection.
     * Useful for multi-tenant applications.
     */
    bundleId?: string;
    /**
     * The app version string to include with events.
     * If not provided, will attempt to auto-detect from the environment.
     */
    appVersion?: string;
    /**
     * The OS version string to include with events.
     * If not provided, will attempt to auto-detect from the environment.
     * For React Native, pass Platform.Version.toString().
     */
    osVersion?: string;
    /**
     * Override the auto-detected platform.
     * Use this when wrapping the SDK (e.g., React Native should pass 'ios' or 'android').
     */
    platform?: Platform;
    /**
     * The SDK identifier. Auto-set to 'javascript' but can be overridden by wrapper SDKs.
     * @default "javascript"
     */
    sdk?: SDK;
    /**
     * The SDK version string. Wrapper SDKs (e.g., React Native) should pass their version here.
     * If not provided, uses the JS SDK's version.
     */
    sdkVersion?: string;
    /**
     * Custom storage adapter. If not provided, uses localStorage in browsers
     * or in-memory storage in non-browser environments.
     */
    storage?: IEventStorage;
    /**
     * Custom network client. If not provided, uses fetch-based client.
     */
    networkClient?: INetworkClient;
    /**
     * Callback invoked when a network error occurs.
     * Useful for reporting errors to external services like Sentry.
     * @param error The error that occurred
     */
    onError?: (error: MGMError) => void;
}
/**
 * Internal resolved configuration with all defaults applied.
 */
export interface ResolvedConfiguration extends Required<Omit<MGMConfiguration, 'storage' | 'networkClient' | 'onError'>> {
    storage?: IEventStorage;
    networkClient?: INetworkClient;
    onError?: (error: MGMError) => void;
}
/**
 * Properties that can be attached to an event.
 * Supports nested objects up to 3 levels deep.
 */
export type EventProperties = Record<string, EventPropertyValue>;
/**
 * Valid types for event property values.
 */
export type EventPropertyValue = null | boolean | number | string | EventPropertyValue[] | {
    [key: string]: EventPropertyValue;
};
/**
 * An analytics event to be tracked.
 */
export interface MGMEvent {
    /**
     * The name of the event. Must match pattern: ^$?[a-zA-Z][a-zA-Z0-9_]*$
     * Max 255 characters.
     */
    name: string;
    /**
     * Unique client-generated ID for deduplication.
     */
    client_event_id: string;
    /**
     * ISO8601 timestamp when the event occurred.
     */
    timestamp: string;
    /**
     * The user ID associated with this event.
     */
    userId?: string;
    /**
     * The session ID associated with this event.
     */
    sessionId?: string;
    /**
     * The platform this event was generated from.
     */
    platform: Platform;
    /**
     * The app version string.
     */
    appVersion?: string;
    /**
     * The app build number (separate from version).
     */
    appBuildNumber?: string;
    /**
     * The OS version string.
     */
    osVersion?: string;
    /**
     * The environment name.
     */
    environment: string;
    /**
     * The device manufacturer (e.g., "Apple", "Samsung").
     */
    deviceManufacturer?: string;
    /**
     * The user's locale (e.g., "en-US").
     */
    locale?: string;
    /**
     * The user's timezone (e.g., "America/New_York").
     */
    timezone?: string;
    /**
     * Custom properties attached to this event.
     */
    properties?: EventProperties;
}
/**
 * Context sent with each batch of events.
 * Applied to all events in the batch server-side.
 */
export interface MGMEventContext {
    platform: Platform;
    appVersion?: string;
    appBuildNumber?: string;
    osVersion?: string;
    userId?: string;
    sessionId?: string;
    environment: string;
    deviceManufacturer?: string;
    locale?: string;
    timezone?: string;
}
/**
 * The payload sent to the events API.
 */
export interface MGMEventsPayload {
    events: MGMEvent[];
    context: MGMEventContext;
}
/**
 * Supported platforms (the actual OS/runtime).
 */
export type Platform = 'web' | 'ios' | 'android' | 'node';
/**
 * SDK identifiers.
 */
export type SDK = 'javascript' | 'react-native' | 'swift' | 'android';
/**
 * Device types for automatic device detection.
 */
export type DeviceType = 'phone' | 'tablet' | 'desktop' | 'tv' | 'watch' | 'unknown';
/**
 * Error types that can occur in the SDK.
 */
export type MGMErrorType = 'NETWORK_ERROR' | 'ENCODING_ERROR' | 'BAD_REQUEST' | 'UNAUTHORIZED' | 'FORBIDDEN' | 'RATE_LIMITED' | 'SERVER_ERROR' | 'INVALID_EVENT_NAME' | 'STORAGE_ERROR' | 'UNKNOWN_ERROR';
/**
 * Result of a network send operation.
 */
export type SendResult = {
    success: true;
} | {
    success: false;
    error: MGMError;
    shouldRetry: boolean;
};
/**
 * Interface for event storage implementations.
 */
export interface IEventStorage {
    /**
     * Store an event for later sending.
     */
    store(event: MGMEvent): Promise<void>;
    /**
     * Fetch up to `limit` events from storage (FIFO order).
     */
    fetchEvents(limit: number): Promise<MGMEvent[]>;
    /**
     * Remove events from storage after successful send.
     */
    removeEvents(count: number): Promise<void>;
    /**
     * Get the current count of stored events.
     */
    eventCount(): Promise<number>;
    /**
     * Clear all stored events.
     */
    clear(): Promise<void>;
}
/**
 * Interface for network client implementations.
 */
export interface INetworkClient {
    /**
     * Send a batch of events to the server.
     */
    sendEvents(payload: MGMEventsPayload, config: ResolvedConfiguration): Promise<SendResult>;
    /**
     * Check if the client is currently rate-limited.
     */
    isRateLimited(): boolean;
    /**
     * Get the retry-after time if rate-limited, or null if not.
     */
    getRetryAfterTime(): Date | null;
}
/**
 * Custom error class for SDK errors.
 */
export declare class MGMError extends Error {
    readonly type: MGMErrorType;
    readonly retryAfter?: number;
    readonly statusCode?: number;
    constructor(type: MGMErrorType, message: string, options?: {
        retryAfter?: number;
        statusCode?: number;
    });
}
/**
 * System event names (prefixed with $).
 */
export declare const SystemEvents: {
    readonly APP_INSTALLED: "$app_installed";
    readonly APP_UPDATED: "$app_updated";
    readonly APP_OPENED: "$app_opened";
    readonly APP_BACKGROUNDED: "$app_backgrounded";
};
/**
 * System property keys (prefixed with $).
 */
export declare const SystemProperties: {
    readonly DEVICE_TYPE: "$device_type";
    readonly DEVICE_MODEL: "$device_model";
    readonly VERSION: "$version";
    readonly PREVIOUS_VERSION: "$previous_version";
    readonly SDK: "$sdk";
};
/**
 * Default configuration values.
 */
export declare const DefaultConfiguration: {
    readonly baseURL: "https://ingest.mostlygoodmetrics.com";
    readonly environment: "production";
    readonly maxBatchSize: 100;
    readonly flushInterval: 30;
    readonly maxStoredEvents: 10000;
    readonly enableDebugLogging: false;
    readonly trackAppLifecycleEvents: true;
};
/**
 * Validation constraints.
 */
export declare const Constraints: {
    readonly MAX_EVENT_NAME_LENGTH: 255;
    readonly MAX_BATCH_SIZE: 1000;
    readonly MIN_BATCH_SIZE: 1;
    readonly MIN_FLUSH_INTERVAL: 1;
    readonly MIN_STORED_EVENTS: 100;
    readonly MAX_STRING_PROPERTY_LENGTH: 1000;
    readonly MAX_PROPERTY_DEPTH: 3;
    readonly MAX_PROPERTY_SIZE_BYTES: number;
    readonly COMPRESSION_THRESHOLD_BYTES: 1024;
};
/**
 * Regular expression for validating event names.
 * Must start with a letter (or $ for system events) followed by alphanumeric and underscores.
 */
export declare const EVENT_NAME_REGEX: RegExp;
//# sourceMappingURL=types.d.ts.map