import { EventProperties, IEventStorage, MGMEvent } from './types';
/**
 * In-memory event storage implementation.
 * Used as a fallback when localStorage is not available,
 * or for testing purposes.
 */
export declare class InMemoryEventStorage implements IEventStorage {
    private events;
    private maxEvents;
    constructor(maxEvents?: number);
    store(event: MGMEvent): Promise<void>;
    fetchEvents(limit: number): Promise<MGMEvent[]>;
    removeEvents(count: number): Promise<void>;
    eventCount(): Promise<number>;
    clear(): Promise<void>;
    /**
     * Update the maximum number of stored events.
     */
    setMaxEvents(maxEvents: number): void;
}
/**
 * LocalStorage-based event storage implementation.
 * Persists events across page reloads and browser restarts.
 */
export declare class LocalStorageEventStorage implements IEventStorage {
    private maxEvents;
    private events;
    constructor(maxEvents?: number);
    private loadEvents;
    private saveEvents;
    store(event: MGMEvent): Promise<void>;
    fetchEvents(limit: number): Promise<MGMEvent[]>;
    removeEvents(count: number): Promise<void>;
    eventCount(): Promise<number>;
    clear(): Promise<void>;
    /**
     * Update the maximum number of stored events.
     */
    setMaxEvents(maxEvents: number): void;
}
/**
 * Create the appropriate storage implementation based on the environment.
 */
export declare function createDefaultStorage(maxEvents: number): IEventStorage;
/**
 * Persistence helpers for user ID and app version.
 * Uses cookies first (for cross-subdomain support), then localStorage as fallback.
 */
declare class PersistenceManager {
    private inMemoryUserId;
    private inMemoryAnonymousId;
    private inMemoryAppVersion;
    private inMemorySuperProperties;
    private cookieDomain;
    private disableCookies;
    /**
     * Configure cookie settings.
     * @param cookieDomain Domain for cross-subdomain cookies (e.g., '.example.com')
     * @param disableCookies If true, only use localStorage (no cookies)
     */
    configureCookies(cookieDomain?: string, disableCookies?: boolean): void;
    /**
     * Check if cookies should be used.
     */
    private shouldUseCookies;
    /**
     * Get the persisted user ID.
     */
    getUserId(): string | null;
    /**
     * Set the user ID (persists across sessions).
     */
    setUserId(userId: string | null): void;
    /**
     * Get the anonymous ID (auto-generated UUID).
     * Checks cookies first, then localStorage, then in-memory.
     */
    getAnonymousId(): string | null;
    /**
     * Set the anonymous ID (persists across sessions).
     * Saves to both cookies and localStorage for redundancy.
     */
    setAnonymousId(anonymousId: string): void;
    /**
     * Initialize the anonymous ID. If an override is provided, use it.
     * Otherwise, use existing persisted ID or generate a new UUID.
     * @param overrideId Optional ID from wrapper SDK (e.g., React Native device ID)
     * @param generateUUID Function to generate a UUID
     */
    initializeAnonymousId(overrideId: string | undefined, generateUUID: () => string): string;
    /**
     * Reset the anonymous ID to a new UUID.
     * @param generateUUID Function to generate a UUID
     */
    resetAnonymousId(generateUUID: () => string): string;
    /**
     * Get the persisted app version (for detecting updates).
     */
    getAppVersion(): string | null;
    /**
     * Set the app version.
     */
    setAppVersion(version: string | null): void;
    /**
     * Check if this is the first time the app has been opened.
     * Uses localStorage to detect first-ever installation.
     */
    isFirstLaunch(): boolean;
    /**
     * Get all super properties.
     */
    getSuperProperties(): EventProperties;
    /**
     * Set a single super property.
     */
    setSuperProperty(key: string, value: EventProperties[string]): void;
    /**
     * Set multiple super properties at once.
     */
    setSuperProperties(properties: EventProperties): void;
    /**
     * Remove a single super property.
     */
    removeSuperProperty(key: string): void;
    /**
     * Clear all super properties.
     */
    clearSuperProperties(): void;
    private saveSuperProperties;
    /**
     * Get the stored identify hash (for debouncing).
     */
    getIdentifyHash(): string | null;
    /**
     * Set the identify hash.
     */
    setIdentifyHash(hash: string): void;
    /**
     * Get the timestamp of the last identify event sent.
     */
    getIdentifyLastSentAt(): number | null;
    /**
     * Set the timestamp of the last identify event sent.
     */
    setIdentifyLastSentAt(timestamp: number): void;
    /**
     * Clear identify debounce state (used when resetting identity).
     */
    clearIdentifyState(): void;
}
export declare const persistence: PersistenceManager;
export {};
//# sourceMappingURL=storage.d.ts.map